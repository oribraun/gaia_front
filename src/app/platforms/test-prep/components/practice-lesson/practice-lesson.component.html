<div class="practice-lesson">
    <ng-template #selected_slide_container let-model="model">
        <app-writing
            *ngIf="model.currentSlide.slide_type === sectionTitles.writing"
            [currentSlide]="model.currentSlide"
            [slideData]="model.slideData"
        ></app-writing>
        <app-unseen
            *ngIf="model.currentSlide.slide_type === sectionTitles.unseen"
            [currentSlide]="model.currentSlide"
            [slideData]="model.slideData"
        ></app-unseen>
        <app-hearing
            *ngIf="model.currentSlide.slide_type === sectionTitles.hearing"
            [currentSlide]="model.currentSlide"
            [slideData]="model.slideData"
        ></app-hearing>
        <app-speaking
            *ngIf="model.currentSlide.slide_type === sectionTitles.speaking"
            [currentSlide]="model.currentSlide"
            [slideData]="model.slideData"
        ></app-speaking>
        <app-video-ielts
            *ngIf="model.currentSlide.slide_type === sectionTitles.video"
            [currentSlide]="model.currentSlide"
            [slideData]="model.slideData"
        ></app-video-ielts>
    </ng-template>
    <div class="white-board">
        <!-- If it is a bundle -->
        <div class="container slides" #slides
             [ngClass]="{
            'slides-bundle':  slidesData.length > 1
         }"
        >
            <div class="outer-scroller"
                 [ngStyle]="{
                'height': (slideHeight !== -1 ? slideHeight + 'px' : ''),
                'width': (slideWidth !== -1 ? slideWidth + 'px' : '')
             }"
            >
                <div class="inner-scroller">
                    <div class="d-flex flex-wrap"
                         [ngClass]="{
                       'd-flex-bundle': slidesData.length > 1,
                     }"
                    >
                        <ng-container *ngFor="let slide of slidesData; let id=index;">
                            <div class="flex-item"
                                 [ngClass]="{
                               'flex-item-full-width': slidesData.length === 1,
                               'flex-item-full-height': slidesData.length === 1,
                               'flex-item-bundle': slidesData.length > 1,
                             }"
                            >
                                <div class="slide {{currentSlide.slide_type}}"
                                     [ngClass]="{
                                  'active-slide':id==currentSlide.index_in_bundle && slidesData.length > 1,
                                  'slide-board-full-height':  slidesData.length > 1,
                                  'slide-board-bundle':  slidesData.length > 1
                                 }"
                                >
                                    <ng-container *ngTemplateOutlet="selected_slide_container;context: {
                                    model: {
                                        currentSlide: slide,
                                        slideData: {
                                            slide_done: id<currentSlide.index_in_bundle && slidesData.length > 1,
                                            is_active: id==currentSlide.index_in_bundle && slidesData.length > 1,
                                            lesson_group_type: lesson_group_type
                                        },
                                    }
                                }"></ng-container>
                                </div>
                            </div>
                            <div class="flex-break" *ngIf="id%2 !== 0"></div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
        <div class="disabled-board" *ngIf="isPause"></div>
    </div>

    <div class="bottom-panel" *ngIf="gotFirstPresentation">
        <div class="title">
            {{currentSlide.slide_title}}
        </div>
        <div class="slide-buttons" *ngIf="currentSlide.slide_type !== 'video'">
            <button class="prev" [disabled]="currentSlideIndex === 0" (click)="onPrevSlide($event)">
                <i class="bi bi-caret-left-fill"></i>
            </button>
            <div>Slide {{currentSlideIndex + 1}}/{{currentSection.slides.length}}</div>
            <button class="next" [disabled]="currentSlideIndex === currentSection.slides.length - 1" (click)="onNextSlide($event)">
                <i class="bi bi-caret-right-fill"></i>
            </button>
        </div>
        <div class="timer-status" *ngIf="currentSlide.slide_type !== 'video'">
            Time lapse: <span>05:43</span>  | status: <span>done</span>
        </div>
        <button class="mark-as-finished" *ngIf="currentSlide.slide_type === 'video' && recommendedVideos.length" (click)="mark_video_as_complete_botton()">
            Mark as watched
        </button>

        <div class="slide-buttons" *ngIf="currentSlide.slide_type === 'video' && recommendedVideos.length">
            <div>Previous Video</div>
            <button class="prev" [disabled]="recommendedVideos[0].id === current_base_lesson_id" (click)="onPrevLesson($event)">
                <i class="bi bi-caret-left-fill"></i>
            </button>
            <button class="next" [disabled]="recommendedVideos[recommendedVideos.length - 1].id === current_base_lesson_id" (click)="onNextLesson($event)">
                <i class="bi bi-caret-right-fill"></i>
            </button>
            <div>Next Video</div>
        </div>
    </div>

<!--    <div class="floating-buttons" *ngIf="currentSection.slides && currentSection.slides.length > 1">-->
<!--        <button class="prev" [disabled]="currentSlideIndex === 0" (click)="onPrevSlide($event)">-->
<!--            <i class="bi bi-chevron-left"></i>-->
<!--        </button>-->
<!--        <button class="next" [disabled]="currentSlideIndex === currentSection.slides.length - 1" (click)="onNextSlide($event)">-->
<!--            <i class="bi bi-chevron-right"></i>-->
<!--        </button>-->
<!--    </div>-->

    <div *ngIf="enable_end_lesson_button" class="floating-buttons fadein-wrapper" style="width:400px; height:80px; border:1px solid red">
        <h5>Good Job, You have completed this lesson</h5>
        <div *ngIf="!vocabulary_was_added" style="position:absolute; top:0">
            <button class="btn btn-primary" (click)="openVocabularyModal()">Review Vocabulary</button>
        </div>
        <div *ngIf="vocabulary_was_added "style="position:absolute; top:0">
            <button class="btn btn-primary" (click)="backToDashboard()">Back to Dashboard</button>
        </div>
    </div>

    <!--modals-->
    <div id="openModal-about" class="modalDialog" [ngClass]="{'modalDialog_target':modalActive}">
        <div>
        <a  title="Close"  (click)="closeModel()"class="close">X</a>
        <h2>Lesson Complete</h2>
        <!-- <div [innerHTML]="presentation.ended_text"></div> -->
        <!-- <div [innerHTML]="grades"></div> -->
        <br>
        <!-- <h2>Score</h2> -->
        <!-- <p [innerHTML]="score"></p> -->
        </div>
    </div>
</div>
